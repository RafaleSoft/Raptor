export

CCCFLAGS =  -DSIMD_NO_ASSEMBLY -DLINUX -fPIC
OUTPUT = $(RAPTOR_ROOT)/Build/Linux/Release/RaptorData
SRCDIR = $(RAPTOR_ROOT)/RaptorData
INCDIRS = -I$(SRCDIR)
LDFLAGS = -Bdynamic -shared -lstdc++

SO = $(OUTPUT)/RaptorData.so.$(RAPTOR_VERSION)
LIB = $(OUTPUT)/RaptorData.lib

all:	$(LIB) $(SO)

clean:
	rm -rf $(OUTPUT)
	mkdir -p $(OUTPUT)

SRC = \
	$(SRCDIR)/RaptorDataManager.cpp \
	$(SRCDIR)/RaptorDataPackager/PackageIO.cpp

OBJ = $(OUTPUT)/RaptorDataManager.o $(OUTPUT)/PackageIO.o
	
$(SO):	$(OBJ)
	g++ -o $(SO) $(LDFLAGS) $(OBJ)
	cp $(SO) $(REDIST)/Bin/

$(LIB):	$(OBJ) 
	ar -qcv $(LIB) $(OBJ)
	cp $(LIB) $(REDIST)/Lib/

$(OUTPUT)/RaptorDataManager.o:	$(SRCDIR)/RaptorDataManager.cpp
	g++ $(CCCFLAGS) $(INCDIRS) -c $(<D)/$(*F).cpp  -o $(OUTPUT)/$(@F)

$(OUTPUT)/PackageIO.o:	$(SRCDIR)/RaptorDataPackager/PackageIO.cpp
	g++ $(CCCFLAGS) $(INCDIRS) -c $(<D)/$(*F).cpp  -o $(OUTPUT)/$(@F)
